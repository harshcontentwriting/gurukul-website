<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bhaktivedanta Vidyabhavan Gurukula, Murbad | BVG Murbad</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Lora:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <style>
        :root { --bg-color: #FFFBEB; --text-color: #374151; --primary-color: #0D9488; --primary-hover: #0F766E; --accent-color: #F59E0B; --accent-hover: #D97706; --dark-bg: #111827; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-color); color: var(--text-color); }
        h1, h2, h3, h4, h5, h6 { font-family: 'Lora', serif; }
        .pattern-bg { background-color: #ffffff; opacity: 1; background-image:  linear-gradient(30deg, #fefce8 12%, transparent 12.5%, transparent 87%, #fefce8 87.5%, #fefce8), linear-gradient(150deg, #fefce8 12%, transparent 12.5%, transparent 87%, #fefce8 87.5%, #fefce8), linear-gradient(30deg, #fefce8 12%, transparent 12.5%, transparent 87%, #fefce8 87.5%, #fefce8), linear-gradient(150deg, #fefce8 12%, transparent 12.5%, transparent 87%, #fefce8 87.5%, #fefce8), linear-gradient(60deg, #fefce877 25%, transparent 25.5%, transparent 75%, #fefce877 75%, #fefce877), linear-gradient(60deg, #fefce877 25%, transparent 25.5%, transparent 75%, #fefce877 75%, #fefce877); background-size: 80px 140px; background-position: 0 0, 0 0, 40px 70px, 40px 70px, 0 0, 40px 70px; }
        .slide { background-size: cover; background-position: center; }
        body.loading { visibility: hidden; }
    </style>
</head>
<body class="loading">

    <!-- Header -->
    <header id="home" class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-md">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <img id="logo_image" src="" alt="BVG Logo" class="h-12 w-12 rounded-full">
                    <a href="#home" class="text-xl md:text-2xl font-bold text-gray-800 tracking-tight hover:text-teal-600 transition-colors">BVG Murbad</a>
                </div>
                <nav class="hidden md:flex items-center space-x-6 lg:space-x-8">
                    <a href="#about" class="nav-link text-gray-600 hover:text-teal-600 font-medium">About Us</a>
                    <a href="#team" class="nav-link text-gray-600 hover:text-teal-600 font-medium">Our Team</a>
                    <a href="#admissions" class="nav-link text-gray-600 hover:text-teal-600 font-medium">Admission</a>
                    <a href="#contact" class="nav-link text-gray-600 hover:text-teal-600 font-medium">Contact Us</a>
                    <a href="#donate" class="cta-button bg-amber-500 hover:bg-amber-600 text-white font-bold py-2 px-5 rounded-full shadow-lg">Donate</a>
                </nav>
                <button id="mobile-menu-button" class="md:hidden text-gray-700"><i data-lucide="menu" class="w-7 h-7"></i></button>
            </div>
        </div>
    </header>

    <main>
        <!-- Hero Slideshow -->
        <section id="hero-slider" class="relative w-full h-[70vh] md:h-[90vh] overflow-hidden">
            <div id="slider-wrapper" class="flex h-full transition-transform duration-700 ease-in-out">
                <!-- Slides will be dynamically inserted here -->
            </div>
            <div id="slider-dots" class="absolute bottom-8 left-1/2 -translate-x-1/2 flex space-x-3 z-20"></div>
        </section>

        <!-- Lineage Section -->
        <section id="about" class="py-20 md:py-28 bg-white">
            <div class="container mx-auto px-6">
                <div id="lineage_section_heading" class="text-center mb-16"></div>
                <div class="grid md:grid-cols-3 gap-10">
                    <div class="text-center p-6 bg-gray-50 rounded-xl shadow-lg">
                        <img id="prabhupada_image" src="" alt="" class="w-32 h-32 rounded-full mx-auto mb-4 shadow-md border-4 border-white object-cover">
                        <h3 id="prabhupada_name" class="text-2xl font-semibold text-gray-800"></h3>
                        <p id="prabhupada_title" class="text-teal-600 font-semibold mt-1"></p>
                        <p id="prabhupada_text" class="text-gray-600 mt-4 text-sm leading-relaxed"></p>
                    </div>
                    <div class="text-center p-6 bg-gray-50 rounded-xl shadow-lg">
                        <img id="maharaj_image" src="" alt="" class="w-32 h-32 rounded-full mx-auto mb-4 shadow-md border-4 border-white object-cover">
                        <h3 id="maharaj_name" class="text-2xl font-semibold text-gray-800"></h3>
                        <p id="maharaj_title" class="text-teal-600 font-semibold mt-1"></p>
                        <p id="maharaj_text" class="text-gray-600 mt-4 text-sm leading-relaxed"></p>
                    </div>
                    <div class="text-center p-6 bg-gray-50 rounded-xl shadow-lg">
                        <img id="das_prabhu_image" src="" alt="" class="w-32 h-32 rounded-full mx-auto mb-4 shadow-md border-4 border-white object-cover">
                        <h3 id="das_prabhu_name" class="text-2xl font-semibold text-gray-800"></h3>
                        <p id="das_prabhu_title" class="text-teal-600 font-semibold mt-1"></p>
                        <p id="das_prabhu_text" class="text-gray-600 mt-4 text-sm leading-relaxed"></p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Our Team Section -->
        <section id="team" class="py-20 md:py-28 pattern-bg">
            <div class="container mx-auto px-6">
                <div id="team_section_heading" class="text-center mb-16"></div>
                <div class="max-w-4xl mx-auto bg-white p-8 rounded-xl shadow-2xl">
                    <img id="team_image" src="" alt="Gurukula Team and Students" class="w-full h-auto rounded-lg mb-8 shadow-md">
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-6 text-center">
                        <div class="p-4 bg-teal-50 rounded-lg"><p id="team_member_1" class="font-semibold text-teal-800"></p></div>
                        <div class="p-4 bg-teal-50 rounded-lg"><p id="team_member_2" class="font-semibold text-teal-800"></p></div>
                        <div class="p-4 bg-teal-50 rounded-lg"><p id="team_member_3" class="font-semibold text-teal-800"></p></div>
                        <div class="p-4 bg-teal-50 rounded-lg"><p id="team_member_4" class="font-semibold text-teal-800"></p></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Donation Section -->
        <section id="donate" class="py-20 md:py-28 pattern-bg">
            <div class="container mx-auto px-6">
                <div id="donation_section_heading" class="text-center max-w-4xl mx-auto"></div>
                <div class="grid lg:grid-cols-2 gap-12 items-start mt-12">
                    <div class="bg-white p-8 rounded-xl shadow-2xl text-center">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-2">Direct Donation</h3>
                        <p class="text-gray-600 mb-4">You can scan the QR code below with any UPI app to contribute.</p>
                        <div class="flex justify-center mb-4">
                            <img id="upi_qr_image" src="" alt="UPI QR Code" class="w-56 h-56 rounded-lg shadow-md border">
                        </div>
                        <p id="upi_note" class="text-sm text-gray-500"></p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-2xl">
                        <h3 class="text-2xl font-semibold text-gray-800 mb-4 text-center">In-Kind Donations</h3>
                        <div class="space-y-6">
                            <div class="flex items-start space-x-4">
                                <div class="bg-amber-100 p-3 rounded-full mt-1"><i data-lucide="package-check" class="w-6 h-6 text-amber-600"></i></div>
                                <div>
                                    <h4 class="font-semibold text-lg text-gray-700">Foodstuff & Supplies</h4>
                                    <p id="inkind_note" class="text-gray-600"></p>
                                </div>
                            </div>
                            <div class="flex items-start space-x-4">
                                <div class="bg-teal-100 p-3 rounded-full mt-1"><i data-lucide="map-pin" class="w-6 h-6 text-teal-600"></i></div>
                                <div>
                                    <h4 class="font-semibold text-lg text-gray-700">Deliver or Post</h4>
                                    <p id="gurukul_address" class="mt-2 font-medium text-gray-800 bg-gray-100 p-3 rounded-md"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Other sections like Admissions can be added here -->
    </main>

    <!-- Footer -->
    <footer id="contact" class="bg-gray-900 text-white">
        <div class="container mx-auto px-6 py-16">
            <div class="grid md:grid-cols-4 gap-10">
                <div class="md:col-span-2">
                    <h3 class="text-lg font-semibold text-amber-400 mb-4">Bhaktivedanta Vidyabhavan Gurukula, Murbad</h3>
                    <p id="footer_description" class="text-gray-400 text-sm"></p>
                    <p id="footer_address" class="text-gray-400 text-sm mt-2"></p>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-amber-400 mb-4">Navigate</h3>
                    <ul class="space-y-2 text-sm">
                        <li><a href="#about" class="text-gray-400 hover:text-white transition">About Us</a></li>
                        <li><a href="#team" class="text-gray-400 hover:text-white transition">Our Team</a></li>
                        <li><a href="#admissions" class="text-gray-400 hover:text-white transition">Admission</a></li>
                        <li><a href="#donate" class="text-gray-400 hover:text-white transition">Donate</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-amber-400 mb-4">Connect With Us</h3>
                    <div class="flex space-x-4 mb-4">
                        <a id="youtube_link" href="#" class="text-gray-400 hover:text-white transition"><i data-lucide="youtube" class="w-6 h-6"></i></a>
                        <a id="instagram_link" href="#" class="text-gray-400 hover:text-white transition"><i data-lucide="instagram" class="w-6 h-6"></i></a>
                        <a id="facebook_link" href="#" class="text-gray-400 hover:text-white transition"><i data-lucide="facebook" class="w-6 h-6"></i></a>
                    </div>
                    <p class="text-sm text-gray-300">Email: <a id="contact_email_link" href="#"><span id="contact_email"></span></a></p>
                    <p id="contact_phone" class="text-sm text-gray-300"></p>
                </div>
            </div>
            <div class="mt-12 border-t border-gray-700 pt-8 text-center text-sm text-gray-500">
                <p>&copy; <span id="year"></span> <span id="copyright_note"></span></p>
            </div>
        </div>
    </footer>
    
    <!-- The New, Smarter Content Display Script -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
          // Add a cache-busting parameter to the fetch URL
          fetch('/_data/content.json?v=' + new Date().getTime())
              .then(response => {
                  if (!response.ok) {
                      throw new Error('Network response was not ok');
                  }
                  return response.json();
              })
              .then(data => {
                  if (data) {
                      populateContent(data);
                  }
                  document.body.classList.remove('loading');
              })
              .catch(err => {
                  console.error("Failed to fetch or parse content.json:", err);
                  document.body.classList.remove('loading');
              });
      });

      function populateContent(data) {
          // Helper to set content
          const setContent = (id, value, isMarkdown = false) => {
              const element = document.getElementById(id);
              if (element) {
                  if (isMarkdown) element.innerHTML = renderMarkdown(value);
                  else element.textContent = value;
              }
          };

          // Helper to set image source
          const setImage = (id, src, alt = '') => {
              const element = document.getElementById(id);
              if (element) {
                  element.src = src;
                  element.alt = alt;
              }
          };
          
          // Helper for links
          const setLink = (id, href) => {
              const element = document.getElementById(id);
              if(element) element.href = href;
          }

          // Simple markdown renderer
          const renderMarkdown = (text) => {
              if (!text) return '';
              return text
                  .replace(/^### (.*$)/gim, '<h3 class="text-xl font-semibold text-gray-800 mb-2">$1</h3>')
                  .replace(/^## (.*$)/gim, '<h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-3">$1</h2>')
                  .replace(/^# (.*$)/gim, '<h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">$1</h1>')
                  .replace(/^(?!<h[1-6]>|<ul>|<p>|<li>)(.*$)/gim, '<p class="text-lg text-gray-600 max-w-3xl mx-auto">$1</p>');
          };
          
          // Populate all fields from JSON data
          setImage('logo_image', data.logo_image);
          setContent('lineage_section_heading', data.lineage_section_heading, true);
          setImage('prabhupada_image', data.prabhupada_image, data.prabhupada_name);
          setContent('prabhupada_name', data.prabhupada_name);
          setContent('prabhupada_title', data.prabhupada_title);
          setContent('prabhupada_text', data.prabhupada_text);
          setImage('maharaj_image', data.maharaj_image, data.maharaj_name);
          setContent('maharaj_name', data.maharaj_name);
          setContent('maharaj_title', data.maharaj_title);
          setContent('maharaj_text', data.maharaj_text);
          setImage('das_prabhu_image', data.das_prabhu_image, data.das_prabhu_name);
          setContent('das_prabhu_name', data.das_prabhu_name);
          setContent('das_prabhu_title', data.das_prabhu_title);
          setContent('das_prabhu_text', data.das_prabhu_text);
          setContent('team_section_heading', data.team_section_heading, true);
          setImage('team_image', data.team_image);
          setContent('team_member_1', data.team_member_1);
          setContent('team_member_2', data.team_member_2);
          setContent('team_member_3', data.team_member_3);
          setContent('team_member_4', data.team_member_4);
          setContent('donation_section_heading', data.donation_section_heading, true);
          setImage('upi_qr_image', data.upi_qr_image);
          setContent('upi_note', data.upi_note);
          setContent('inkind_note', data.inkind_note);
          setContent('gurukul_address', data.gurukul_address);
          setContent('footer_description', data.footer_description);
          setContent('footer_address', data.footer_address);
          setLink('youtube_link', data.youtube_link);
          setLink('instagram_link', data.instagram_link);
          setLink('facebook_link', data.facebook_link);
          setContent('contact_email', data.contact_email);
          setLink('contact_email_link', 'mailto:' + data.contact_email);
          setContent('contact_phone', 'Phone: ' + data.contact_phone);
          setContent('copyright_note', data.copyright_note);
          
          // Populate Slideshow
          const sliderWrapper = document.getElementById('slider-wrapper');
          if (data.slideshow && data.slideshow.length > 0) {
              data.slideshow.forEach(slide => {
                  const slideEl = document.createElement('div');
                  slideEl.className = 'slide min-w-full h-full relative flex items-center justify-center text-center text-white';
                  slideEl.style.backgroundImage = `url('${slide.background_image}')`;
                  slideEl.innerHTML = `
                      <div class="absolute inset-0 bg-black/50"></div>
                      <div class="container mx-auto px-6 z-10">
                          <h1 class="text-4xl md:text-6xl lg:text-7xl font-bold leading-tight mb-4" style="text-shadow: 2px 2px 10px rgba(0,0,0,0.7);">${slide.headline}</h1>
                          <p class="text-xl md:text-2xl font-light mb-10 max-w-3xl mx-auto" style="text-shadow: 1px 1px 5px rgba(0,0,0,0.7);">${slide.subheadline}</p>
                          <a href="${slide.button_link}" class="cta-button bg-amber-500 hover:bg-amber-600 text-white font-bold py-4 px-10 rounded-full text-lg shadow-2xl">${slide.button_text}</a>
                      </div>`;
                  sliderWrapper.appendChild(slideEl);
              });
              initializeSlider();
          }
      }

      function initializeSlider() {
          const sliderWrapper = document.getElementById('slider-wrapper');
          const slides = Array.from(sliderWrapper.children);
          const dotsContainer = document.getElementById('slider-dots');
          let currentIndex = 0;
          let slideInterval;
          if(slides.length === 0) return;

          slides.forEach((_, index) => {
              const dot = document.createElement('button');
              dot.classList.add('w-2.5', 'h-2.5', 'rounded-full', 'bg-white/50', 'hover:bg-white', 'transition-all');
              dot.addEventListener('click', () => {
                  goToSlide(index);
                  resetInterval();
              });
              dotsContainer.appendChild(dot);
          });
          const dots = Array.from(dotsContainer.children);
          
          function goToSlide(index) {
              sliderWrapper.style.transform = `translateX(-${index * 100}%)`;
              dots.forEach(d => d.classList.remove('bg-white', 'w-3.5', 'h-3.5'));
              dots[index].classList.add('bg-white', 'w-3.5', 'h-3.5');
              currentIndex = index;
          }

          function nextSlide() {
              currentIndex = (currentIndex + 1) % slides.length;
              goToSlide(currentIndex);
          }
          
          function startInterval() {
              slideInterval = setInterval(nextSlide, 5000);
          }
          function resetInterval() {
              clearInterval(slideInterval);
              startInterval();
          }
          goToSlide(0);
          startInterval();
      }
        
      // Standard helper scripts
      lucide.createIcons();
      document.getElementById('year').textContent = new Date().getFullYear();
      const mobileMenuButton = document.getElementById('mobile-menu-button');
      const mobileMenu = document.getElementById('mobile-menu');
      mobileMenuButton.addEventListener('click', () => { mobileMenu.classList.toggle('hidden'); });

      // Identity helper script
      if (window.netlifyIdentity) {
        window.netlifyIdentity.on("init", user => {
          if (!user) {
            window.netlifyIdentity.on("login", () => {
              document.location.href = "/admin/";
            });
          }
        });
      }
    </script>
</body>
</html>
