<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bhaktivedanta Vidyabhavan Gurukula, Murbad | BVG Murbad</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Lora:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <style>
        :root { --bg-color: #FFFBEB; --text-color: #374151; --primary-color: #0D9488; --primary-hover: #0F766E; --accent-color: #F59E0B; --accent-hover: #D97706; --dark-bg: #111827; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-color); color: var(--text-color); }
        h1, h2, h3, h4, h5, h6 { font-family: 'Lora', serif; }
        .pattern-bg { background-color: #fafafa; }
        .slide, .gallery-slide { background-size: cover; background-position: center; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out, padding-top 0.3s ease-out, padding-bottom 0.3s ease-out; }
        .accordion-content.open { max-height: 1000px; padding-top: 1rem; padding-bottom: 1rem; }
        .gallery-caption { position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.6); color: white; padding: 1.5rem; text-align: center; font-family: 'Lora', serif; font-size: 1.25rem; transition: opacity 0.3s ease; }
    </style>
</head>
<body class="antialiased">

    <!-- Header -->
    <header id="home" class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-md"><!-- Header code... --></header>

    <main>
        <!-- Hero Slideshow -->
        <section id="hero-slider" class="relative w-full h-[70vh] md:h-[90vh] overflow-hidden">
            <div id="slider-wrapper" class="flex h-full transition-transform duration-700 ease-in-out"></div>
            <div id="slider-dots" class="absolute bottom-8 left-1/2 -translate-x-1/2 flex space-x-3 z-20"></div>
        </section>

        <!-- Lineage Section -->
        <section id="about" class="py-20 md:py-28 bg-white"><!-- Lineage Section content... --></section>

        <!-- Vision Section -->
        <section id="vision" class="py-20 md:py-28 pattern-bg"><!-- Vision Section content... --></section>
        
        <!-- Our Team Section -->
        <section id="team" class="py-20 md:py-28 bg-white"><!-- Team Section content... --></section>
        
        <!-- NEW Glimpses Slideshow Section -->
        <section id="gallery" class="py-20 md:py-28 pattern-bg">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 id="glimpses_section_heading" class="text-3xl md:text-4xl font-bold text-gray-900 mb-3"></h2>
                    <p id="glimpses_subheading" class="text-lg text-gray-600 max-w-3xl mx-auto"></p>
                </div>
                <div id="gallery-slider" class="relative w-full max-w-4xl mx-auto h-[60vh] overflow-hidden rounded-xl shadow-2xl">
                    <div id="gallery-slider-wrapper" class="flex h-full transition-transform duration-700 ease-in-out">
                        <!-- Gallery Slides will be dynamically inserted here -->
                    </div>
                    <button id="gallery-prev" class="absolute top-1/2 left-4 -translate-y-1/2 bg-white/50 hover:bg-white p-2 rounded-full z-20"><i data-lucide="chevron-left" class="w-6 h-6 text-gray-800"></i></button>
                    <button id="gallery-next" class="absolute top-1/2 right-4 -translate-y-1/2 bg-white/50 hover:bg-white p-2 rounded-full z-20"><i data-lucide="chevron-right" class="w-6 h-6 text-gray-800"></i></button>
                    <div id="gallery-slider-dots" class="absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2 z-20"></div>
                </div>
            </div>
        </section>

        <!-- Donation Section -->
        <section id="donate" class="py-20 md:py-28 bg-white"><!-- Donation Section content... --></section>

        <!-- Admissions Section -->
        <section id="admissions" class="py-20 md:py-28 pattern-bg"><!-- Admissions Section content... --></section>
    </main>

    <!-- Footer -->
    <footer id="contact" class="bg-gray-900 text-white"><!-- Footer content... --></footer>
    
    <!-- THE COMPLETE, CORRECTED SCRIPT SECTION -->
    <script>
      // ... (All previous script content up to populateGallery)

      function populateGallery(items) {
          const wrapper = document.getElementById('gallery-slider-wrapper');
          if (!wrapper || !items) return;
          wrapper.innerHTML = '';
          items.forEach(item => {
              if (item && item.image) {
                  const slideEl = document.createElement('div');
                  slideEl.className = 'gallery-slide min-w-full h-full relative flex items-center justify-center';
                  slideEl.style.backgroundImage = `url('${item.image}')`;
                  if(item.caption) {
                    slideEl.innerHTML = `<div class="gallery-caption">${item.caption}</div>`;
                  }
                  wrapper.appendChild(slideEl);
              }
          });
          initializeSlideshowGallery();
      }
      
      function initializeSlideshowGallery() {
          const slider = document.getElementById('gallery-slider');
          const wrapper = document.getElementById('gallery-slider-wrapper');
          const dotsContainer = document.getElementById('gallery-slider-dots');
          const prevBtn = document.getElementById('gallery-prev');
          const nextBtn = document.getElementById('gallery-next');

          if (!slider || !wrapper) return;
          const slides = Array.from(wrapper.children);
          if (slides.length <= 1) {
              if (dotsContainer) dotsContainer.style.display = 'none';
              if (prevBtn) prevBtn.style.display = 'none';
              if (nextBtn) nextBtn.style.display = 'none';
              return;
          }

          dotsContainer.innerHTML = '';
          let currentIndex = 0;
          let slideInterval = null;
          let touchstartX = 0;
          let touchendX = 0;

          slides.forEach((_, index) => {
              const dot = document.createElement('button');
              dot.classList.add('w-2', 'h-2', 'rounded-full', 'bg-white/60', 'hover:bg-white', 'transition-all');
              dot.addEventListener('click', () => { goToSlide(index); resetInterval(); });
              dotsContainer.appendChild(dot);
          });
          const dots = Array.from(dotsContainer.children);
          
          function goToSlide(index) {
              wrapper.style.transform = `translateX(-${index * 100}%)`;
              dots.forEach(d => d.classList.remove('bg-white', 'scale-125'));
              dots[index].classList.add('bg-white', 'scale-125');
              currentIndex = index;
          }

          function nextSlide() { goToSlide((currentIndex + 1) % slides.length); }
          function prevSlide() { goToSlide((currentIndex - 1 + slides.length) % slides.length); }
          function startInterval() { slideInterval = setInterval(nextSlide, 5000); }
          function resetInterval() { clearInterval(slideInterval); startInterval(); }

          function handleGesture() {
              if (touchendX < touchstartX - 50) nextSlide();
              if (touchendX > touchstartX + 50) prevSlide();
          }

          nextBtn.addEventListener('click', () => { nextSlide(); resetInterval(); });
          prevBtn.addEventListener('click', () => { prevSlide(); resetInterval(); });
          slider.addEventListener('touchstart', e => { touchstartX = e.changedTouches[0].screenX; });
          slider.addEventListener('touchend', e => { touchendX = e.changedTouches[0].screenX; handleGesture(); resetInterval(); });
          
          goToSlide(0);
          startInterval();
      }

      // ... (All other script functions like initializeSlider, populateTeam, etc. remain the same)
    </script>
</body>
</html>
